
'/*
'開始
'*/

Function macroStart()

    With Application
    
        .Calculation = xlCalculationManual  '自動計算OFF
        .ScreenUpdating = False             '描画OFF
        .EnableEvents = False               'イベントOFF
        .Cursor = xlDefault                 'カーソルOFF
    
    End With

End Function _


'/*
'終了
'*/

Function macroEnd()

    With Application
    
        .Cursor = xlDefault                 'カーソルOFF
        .EnableEvents = False               'イベントOFF
        .ScreenUpdating = False             '描画OFF
        .Calculation = xlCalculationManual  '自動計算OFF
    
    End With

End Function _


Function deleteWorksheet(ws As Worksheet)

    Application.DisplayAlerts = False
    ws.Delete
    Application.DisplayAlerts = True

End Function _


Function deleteBook(wbPath As String)

    If Dir(wbPath) <> "" Then
        
        'Application.DisplayAlerts = False
        Kill wbPath
        'Application.DisplayAlerts = True
        
    Else
        
        MsgBox "存在なし:= [" & wbPath & "]"
        
    End If

End Function _


'/*
'ファイルの存在確認
'
'   @param  filePath(参照ファイルのフルパス)
'
'   @return [Boolean]   True   readFile(参照ファイルのフルパス)
'                       False 「(参照ファイル名)が存在しない」とメッセージ表示してマクロ終了
'*/

Function findFile(filePath As String) As String

    On Error GoTo functionError

        Dim result As String
        result = Dir(filePath)
    
        If result = "" Then
            MsgBox "存在なし:= [" & fileName & "]"
            End
        End If
    
        findFile = result
    
        Exit Function
    
functionError:
    MsgBox "FunctionE:= [VBA]Tool.findFile"
    End
    
End Function _


'/*
'このbookの最後に指定した名称でシートを追加
'   ※同名のシートが存在する場合は先に削除'
'
'   @param  [String]指定するシート名
'
'   @return [Worksheet]追加したシートオブジェクト
'*/

Function addSheet(addSheetName As String) As Worksheet
    
    On Error GoTo functionError
    
            For Each Sheet In ThisWorkbook.Worksheets
            
                If Sheet.name = addSheetName Then
                    
                    deleteWorksheet ThisWorkbook.Worksheets(addSheetName)
                    Exit For
                    
                End If
                
            Next
        
        With ThisWorkbook.Worksheets
        
            Dim ws As Worksheet
        
            Set ws = .Add(after:=.Item(.Count))
            ws.name = addSheetName
            
            Set addSheet = ws
            
        End With
        
        Exit Function
        
functionError:
    MsgBox "functionE:= [VBA]Tool.addSheet"
    End
    
End Function _


'/*
'対象Bookが開いているか確認
'
'   @param  [String]対象ファイルのパス
'
'   @return [Boolean]開いていなければTrue
'*/

Function isBookOpend(ByVal filePath As String) As Boolean

    On Error Resume Next
    
        Open filePath For Append As #1
        Close #1
        
        If Err.Number > 0 Then
        
            isBookOpend = True
            
        Else
        
            isBookOpend = False
            
        End If

End Function _


'/*
'選択したブックのパスを取得する
'
'   @param  [String]選択させるファイルの種類
'
'   @return [String]指定したBookのファイルパス
'*/

Function getPathSelectBook(ByVal fileType As String) As String

    Dim objDialog As FileDialog
    Set objDialog = Application.FileDialog(msoFileDialogFilePicker)
    Dim folderPath As String
    folderPath = ThisWorkbook.Path

    With objDialog
    
        .AllowMultiSelect = False
        .InitialFileName = folderPath
        .Title = [fileType] & "を選択してください"
        
        If .Show Then
        
            getPathSelectBook = .SelectedItems(1)
            
        Else
        
            End
        
        End If
    
    End With

End Function _


'/*
'このworkbook以外のbookを閉じる
'   ※上書き保存しない
'*/

Function closeAllWorkbook()

    Dim wb As Workbook

    For Each wb In Workbooks
    
        If Not wb.name = ThisWorkbook.name Then
        
            wb.Close saveChanges:=False
            
        End If
        
    Next

End Function _


'/*
'文字の角度を変更する
'
'   @param  [Range]変更箇所
'   @param  [Integer]角度
'
'*/

Function changeRaneAngle(myRange As Range, angle As Integer)

    myRange.Orientation = angle

End Function _


'/*
'文字を縦書きにする
'
'   @param  [Range]変更箇所
'
'*/

Function changeRangeVertical(myRange As Range)

    myRange.Orientation = xlVertical

End Function _


'/*
'指定Rangeからの最終行を取得する
'
'   @param  [Worksheet]対象のシート
'   @param  [Range]始点
'
'   @return [Lomg]最終行
'*/

Function getLastRow(myRange As Range) As Long

    getLastRow = myRange.SpecialCells(xlLastCell).Row

End Function _


'/*
'指定Rangeからの最終列を取得する
'
'   @param  [Worksheet]対象のシート
'   @param  [Range]始点
'
'   @return [Lomg]最終列
'*/

Function getLastColumn(myRange As Range) As Long

    getLastColumn = myRange.SpecialCells(xlLastCell).Column

End Function _


Sub setA1()
  Dim ws As Worksheet
  For Each ws In Worksheets
    ws.Select
    ws.Range("A1").Select
  Next
  Sheets(1).Select
  
  ThisWorkbook.Save
End Sub
